{
  "version": "1.0.0",
  "description": "Security rules for static code analysis",
  "last_updated": "2025-01-01",
  "rules": [
    {
      "id": "JS001",
      "name": "Eval Usage",
      "description": "Using eval() can execute arbitrary code and is a significant security risk.",
      "type": "regex",
      "pattern": "\\beval\\s*\\(",
      "languages": ["javascript", "typescript"],
      "severity": "critical",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-95",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Avoid using eval(). Use JSON.parse() for parsing JSON or Function constructor with extreme caution."
    },
    {
      "id": "JS002",
      "name": "Command Execution via Child Process",
      "description": "Using child_process.exec() with user input may allow remote command execution.",
      "type": "regex",
      "pattern": "child_process\\.exec\\s*\\(",
      "languages": ["javascript", "typescript"],
      "severity": "critical",
      "confidence": "high",
      "category": "command_injection",
      "cwe_id": "CWE-78",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Use execFile with argument arrays and strict input validation instead of exec()."
    },
    {
      "id": "JS003",
      "name": "DOM XSS via innerHTML",
      "description": "Direct innerHTML assignment can lead to Cross-Site Scripting (XSS) vulnerabilities.",
      "type": "regex",
      "pattern": "\\.innerHTML\\s*=",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "medium",
      "category": "xss",
      "cwe_id": "CWE-79",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Use textContent for plain text or sanitize HTML content before assignment with libraries like DOMPurify."
    },
    {
      "id": "JS004",
      "name": "String-based Timer Functions",
      "description": "Passing strings to setTimeout/setInterval executes code like eval().",
      "type": "regex",
      "pattern": "set(?:Timeout|Interval)\\s*\\(\\s*(['\"]).+?\\1",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-94",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Use function references instead of strings."
    },
    {
      "id": "JS005",
      "name": "Weak Cryptographic Hash",
      "description": "Weak hash algorithm (MD5/SHA1) detected.",
      "type": "regex",
      "pattern": "crypto\\.createHash\\s*\\(\\s*['\\\"](md5|sha1)['\\\"]",
      "languages": ["javascript", "typescript"],
      "severity": "medium",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-327",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use SHA-256/512 or password hashing like bcrypt/argon2."
    },
    {
      "id": "JS006",
      "name": "Error Stack Exposure",
      "description": "Leaking errors/stacks to clients reveals sensitive information.",
      "type": "regex",
      "pattern": "res\\.send\\s*\\(\\s*err(\\.stack)?\\s*\\)",
      "languages": ["javascript", "typescript"],
      "severity": "low",
      "confidence": "high",
      "category": "information_disclosure",
      "cwe_id": "CWE-209",
      "owasp_category": "A09:2021-Security Logging and Monitoring Failures",
      "remediation": "Log errors server-side and return generic messages to clients."
    },
    {
      "id": "JS007",
      "name": "Hardcoded Secrets Detection",
      "description": "Possible hardcoded secret or credential detected.",
      "type": "regex",
      "pattern": "(api[-_]?key|secret|token)\\s*[:=]\\s*['\"][A-Za-z0-9_\\-]{16,}['\"]",
      "languages": ["javascript", "typescript"],
      "severity": "critical",
      "confidence": "medium",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Move secrets to environment variables or a secure vault."
    },
    {
      "id": "JS008",
      "name": "Document.write with User Input",
      "description": "document.write() with user-controlled data can lead to DOM XSS.",
      "type": "regex",
      "pattern": "document\\.write\\s*\\([^)]*(location\\.search|window\\.location|document\\.URL)",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "medium",
      "category": "xss",
      "cwe_id": "CWE-79",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Avoid document.write(); use DOM APIs and sanitize input."
    },
    {
      "id": "JS009",
      "name": "Weak Randomness with Math.random()",
      "description": "Weak randomness with Math.random() for security-sensitive operations.",
      "type": "regex",
      "pattern": "\\bMath\\.random\\s*\\(",
      "languages": ["javascript", "typescript"],
      "severity": "medium",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-338",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use crypto.getRandomValues() instead."
    },
    {
      "id": "JS010",
      "name": "Console Logging in Production",
      "description": "Console logging detected which may leak sensitive information in production.",
      "type": "regex",
      "pattern": "\\bconsole\\.(log|debug|info|warn|error)\\s*\\(",
      "languages": ["javascript", "typescript"],
      "severity": "low",
      "confidence": "high",
      "category": "information_disclosure",
      "cwe_id": "CWE-200",
      "owasp_category": "A09:2021-Security Logging and Monitoring Failures",
      "remediation": "Remove console statements in production builds."
    },
    {
      "id": "JS011",
      "name": "Sensitive Data in Browser Storage",
      "description": "Sensitive data stored in localStorage/sessionStorage can be stolen via XSS.",
      "type": "regex",
      "pattern": "(localStorage|sessionStorage)\\.setItem\\s*\\([^)]*(password|token|key|secret)",
      "languages": ["javascript", "typescript"],
      "severity": "medium",
      "confidence": "medium",
      "category": "information_disclosure",
      "cwe_id": "CWE-922",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Do not store secrets in localStorage/sessionStorage. Use HttpOnly cookies."
    },
    {
      "id": "JS012",
      "name": "Open Redirect Vulnerability",
      "description": "Unvalidated user input in redirects can lead to open redirect attacks.",
      "type": "regex",
      "pattern": "window\\.location(?:\\.href)?\\s*=\\s*(location\\.search|window\\.location|document\\.URL)",
      "languages": ["javascript", "typescript"],
      "severity": "medium",
      "confidence": "medium",
      "category": "open_redirect",
      "cwe_id": "CWE-601",
      "owasp_category": "A01:2021-Broken Access Control",
      "remediation": "Validate redirect URLs against a whitelist."
    },
    {
      "id": "JS013",
      "name": "PostMessage without Origin Validation",
      "description": "postMessage listener detected without proper origin validation.",
      "type": "regex",
      "pattern": "window\\.addEventListener\\s*\\(\\s*['\"]message['\"]",
      "languages": ["javascript", "typescript"],
      "severity": "medium",
      "confidence": "low",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-346",
      "owasp_category": "A07:2021-Identification and Authentication Failures",
      "remediation": "Always validate event.origin before handling messages."
    },
    {
      "id": "JS014",
      "name": "Client-side Authorization Logic",
      "description": "Authorization logic found in client-side code can be bypassed.",
      "type": "regex",
      "pattern": "if\\s*\\([^)]*(user\\s*\\.?role|currentUser\\s*\\.?role|user\\s*\\[\\s*['\"]role['\"]\\s*\\])[^)]*\\)",
      "languages": ["javascript", "typescript"],
      "severity": "medium",
      "confidence": "medium",
      "category": "broken_access_control",
      "cwe_id": "CWE-602",
      "owasp_category": "A01:2021-Broken Access Control",
      "remediation": "Do not rely on client-side authorization checks. Always enforce access control on the server side."
    },
    {
      "id": "JS015",
      "name": "CSP with unsafe-inline",
      "description": "Content Security Policy with unsafe-inline weakens XSS protection.",
      "type": "regex",
      "pattern": "(res\\.set(Header|HeaderSync)?\\s*\\([^)]*['\"]Content-Security-Policy['\"][^)]*unsafe-inline)",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "high",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-693",
      "owasp_category": "A04:2021-Insecure Design",
      "remediation": "Avoid unsafe-inline; use nonces or hashes in CSP."
    },
    {
      "id": "JS016",
      "name": "Outdated jQuery Version",
      "description": "Old jQuery v1.x detected, which has multiple XSS vulnerabilities.",
      "type": "regex",
      "pattern": "(jquery[-.]1\\.[0-9]+\\.[0-9]+(\\.min)?\\.js)",
      "languages": ["javascript", "typescript"],
      "severity": "medium",
      "confidence": "high",
      "category": "vulnerable_component",
      "cwe_id": "CWE-1104",
      "owasp_category": "A06:2021-Vulnerable and Outdated Components",
      "remediation": "Upgrade to the latest jQuery version (≥3.6.x)."
    },
    {
      "id": "JS017",
      "name": "Server-Side Request Forgery (SSRF)",
      "description": "Unvalidated user input flows into HTTP request functions.",
      "type": "regex",
      "pattern": "\\b(fetch|axios|get|post)\\s*\\([^)]*(req\\.|request\\.|user|query|params)",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "medium",
      "category": "ssrf",
      "cwe_id": "CWE-918",
      "owasp_category": "A10:2021-SSRF",
      "remediation": "Validate and restrict request URLs against an allowlist."
    },
    {
      "id": "JS018",
      "name": "TLS Verification Disabled",
      "description": "Disabling TLS verification leaves the app vulnerable to MITM attacks.",
      "type": "regex",
      "pattern": "rejectUnauthorized\\s*:\\s*false",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-295",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Always set rejectUnauthorized to true in production."
    },
    {
      "id": "JS019",
      "name": "ReDoS Vulnerability",
      "description": "Regex pattern with nested quantifiers may cause ReDoS.",
      "type": "regex",
      "pattern": "\\((?:\\w|\\.)+\\+\\)\\+",
      "languages": ["javascript", "typescript"],
      "severity": "medium",
      "confidence": "medium",
      "category": "dos",
      "cwe_id": "CWE-400",
      "owasp_category": "A09:2021-Security Logging and Monitoring Failures",
      "remediation": "Refactor regex to avoid catastrophic backtracking."
    },
    {
      "id": "JS020",
      "name": "Path Traversal via File Operations",
      "description": "User input flows into file system operations without validation.",
      "type": "regex",
      "pattern": "fs\\.(readFile|writeFile|appendFile)\\s*\\(\\s*req\\.(query|body|params)",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "medium",
      "category": "path_traversal",
      "cwe_id": "CWE-22",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Validate and sanitize file paths. Never use raw user input for filesystem access."
    },
    {
      "id": "JS021",
      "name": "Insecure JWT Decode",
      "description": "Using jwt.decode() without verifying the signature is insecure.",
      "type": "regex",
      "pattern": "jwt\\.decode\\s*\\(",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "high",
      "category": "authentication",
      "cwe_id": "CWE-347",
      "owasp_category": "A07:2021-Identification and Authentication Failures",
      "remediation": "Use jwt.verify() instead of jwt.decode() for authentication flows."
    },
    {
      "id": "JS022",
      "name": "Insecure AES Mode (ECB)",
      "description": "Insecure AES mode: ECB detected → deterministic encryption leaks patterns.",
      "type": "regex",
      "pattern": "crypto\\.createCipher(iv)?\\(['\"]aes-\\d+-ecb['\"]",
      "languages": ["javascript", "typescript"],
      "severity": "critical",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-327",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use AES-GCM (preferred) or AES-CBC with random IVs."
    },
    {
      "id": "JS023",
      "name": "Insecure Cipher (DES/3DES)",
      "description": "Insecure cipher: DES/3DES detected → weak and deprecated.",
      "type": "regex",
      "pattern": "crypto\\.createCipher(iv)?\\(['\"]des(['\"]|3des['\"]|ede['\"])",
      "languages": ["javascript", "typescript"],
      "severity": "critical",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-326",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use AES-GCM or ChaCha20 instead of DES/3DES."
    },
    {
      "id": "JS024",
      "name": "Insecure Cipher (RC4)",
      "description": "Insecure cipher: RC4 detected → statistically weak and broken.",
      "type": "regex",
      "pattern": "crypto\\.createCipher(iv)?\\(['\"]rc4",
      "languages": ["javascript", "typescript"],
      "severity": "critical",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-327",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Avoid RC4; use AES-GCM or ChaCha20."
    },
    {
      "id": "JS025",
      "name": "Weak Hash (SHA-1)",
      "description": "Weak hash detected: SHA-1 is deprecated and collision-prone.",
      "type": "regex",
      "pattern": "crypto\\.createHash\\(['\"]sha1['\"]\\)",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-328",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use SHA-256, SHA-3, or Argon2/bcrypt for passwords."
    },
    {
      "id": "JS026",
      "name": "dangerouslySetInnerHTML Usage",
      "description": "Usage of dangerouslySetInnerHTML can lead to Cross-Site Scripting (XSS).",
      "type": "regex",
      "pattern": "dangerouslySetInnerHTML",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "high",
      "category": "xss",
      "cwe_id": "CWE-79",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Avoid dangerouslySetInnerHTML. Use safe templating libraries or sanitize HTML."
    },
    {
      "id": "JS027",
      "name": "Memory Exhaustion Risk",
      "description": "Large array allocation may cause denial of service (memory exhaustion).",
      "type": "regex",
      "pattern": "new Array\\(Number\\.MAX_SAFE_INTEGER\\)",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "medium",
      "category": "dos",
      "cwe_id": "CWE-770",
      "owasp_category": "A06:2021-DoS",
      "remediation": "Limit allocation sizes and validate input before creating arrays."
    },
    {
      "id": "JS028",
      "name": "Timing Attack Risk",
      "description": "Timing-based security check detected; may leak sensitive information.",
      "type": "regex",
      "pattern": "setTimeout\\s*\\([^)]*\\b(password|secret|token|compare)\\b",
      "languages": ["javascript", "typescript"],
      "severity": "medium",
      "confidence": "low",
      "category": "weak_crypto",
      "cwe_id": "CWE-208",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Do not use time-based checks for secrets. Use constant-time comparison functions."
    },
    {
      "id": "JS029",
      "name": "Function Constructor Usage",
      "description": "Use of Function constructor is dangerous with untrusted input.",
      "type": "regex",
      "pattern": "new\\s+Function\\s*\\(",
      "languages": ["javascript", "typescript"],
      "severity": "critical",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-95",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Avoid Function constructor; refactor to safe static functions."
    },
    {
      "id": "JS030",
      "name": "Obfuscated Eval with Base64",
      "description": "Obfuscated eval with base64 decoding detected.",
      "type": "regex",
      "pattern": "eval\\s*\\(\\s*atob\\s*\\(",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-94",
      "owasp_category": "A08:2021-Software Integrity Failures",
      "remediation": "Avoid obfuscation techniques like eval(atob()), as they hide potentially malicious code."
    },
    {
      "id": "PHP001",
      "name": "PHP Eval Usage",
      "description": "Using eval() in PHP can execute arbitrary code.",
      "type": "regex",
      "pattern": "\\beval\\s*\\(",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-95",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Avoid eval(). Use include/require for dynamic code loading with proper validation."
    },
    {
      "id": "PHP002",
      "name": "PHP Command Execution",
      "description": "Command execution functions can lead to injection if arguments are tainted.",
      "type": "regex",
      "pattern": "@?\\s*(system|exec|shell_exec|passthru)\\s*\\(",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "high",
      "category": "command_injection",
      "cwe_id": "CWE-78",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Avoid shell execution; use built-in APIs and strict validation."
    },
    {
      "id": "PHP003",
      "name": "PHP XSS via Echo",
      "description": "Echoing unescaped user input can cause XSS.",
      "type": "regex",
      "pattern": "echo\\s+\\$_(GET|POST|REQUEST|COOKIE)\\b",
      "languages": ["php"],
      "severity": "high",
      "confidence": "medium",
      "category": "xss",
      "cwe_id": "CWE-79",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Encode output with htmlspecialchars and validate inputs."
    },
    {
      "id": "PHP004",
      "name": "PHP Weak Hash Algorithm",
      "description": "Weak hash algorithm (MD5/SHA1) used.",
      "type": "regex",
      "pattern": "\\b(md5|sha1)\\s*\\(",
      "languages": ["php"],
      "severity": "medium",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-327",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use password_hash (bcrypt/argon2) or sodium/openssl strong hashes."
    },
    {
      "id": "PHP005",
      "name": "PHP Error Information Leak",
      "description": "Debugging functions may leak sensitive information.",
      "type": "regex",
      "pattern": "(var_dump|print_r|die|phpinfo)\\s*\\(",
      "languages": ["php"],
      "severity": "low",
      "confidence": "high",
      "category": "information_disclosure",
      "cwe_id": "CWE-209",
      "owasp_category": "A09:2021-Security Logging and Monitoring Failures",
      "remediation": "Log errors server-side and show generic error messages."
    },
    {
      "id": "PHP006",
      "name": "PHP SQL Injection with mysqli_query",
      "description": "Use of mysqli_query with untrusted input may lead to SQL Injection.",
      "type": "regex",
      "pattern": "@?\\s*mysqli_query\\s*\\(",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "high",
      "category": "sql_injection",
      "cwe_id": "CWE-89",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Always use prepared statements (mysqli_stmt or PDO)."
    },
    {
      "id": "PHP007",
      "name": "PHP Deprecated mysql API",
      "description": "Use of deprecated mysql_* API with untrusted input allows SQL Injection.",
      "type": "regex",
      "pattern": "mysql_query\\s*\\(",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "high",
      "category": "sql_injection",
      "cwe_id": "CWE-89",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Migrate to mysqli or PDO with prepared statements."
    },
    {
      "id": "PHP008",
      "name": "PHP Dynamic File Inclusion",
      "description": "Dynamic include/require detected. May allow LFI/RFI.",
      "type": "regex",
      "pattern": "@?\\s*(include|require)(_once)?\\s*\\(",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "medium",
      "category": "path_traversal",
      "cwe_id": "CWE-98",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Never include user input in include/require paths. Use whitelists."
    },
    {
      "id": "PHP009",
      "name": "PHP Path Traversal via file_get_contents",
      "description": "file_get_contents on user input may allow path traversal / arbitrary file read.",
      "type": "regex",
      "pattern": "@?\\s*file_get_contents\\s*\\(",
      "languages": ["php"],
      "severity": "high",
      "confidence": "medium",
      "category": "path_traversal",
      "cwe_id": "CWE-22",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Avoid using unvalidated input in file_get_contents."
    },
    {
      "id": "PHP010",
      "name": "PHP Insecure Deserialization",
      "description": "Unserialize on untrusted input detected.",
      "type": "regex",
      "pattern": "unserialize\\s*\\(",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "medium",
      "category": "insecure_deserialization",
      "cwe_id": "CWE-502",
      "owasp_category": "A08:2021-Software and Data Integrity Failures",
      "remediation": "Avoid unserialize(); use JSON instead, or validate strictly."
    },
    {
      "id": "PHP011",
      "name": "PHP Weak Randomness",
      "description": "Use of mt_rand() for security tokens is unsafe.",
      "type": "regex",
      "pattern": "mt_rand\\s*\\(",
      "languages": ["php"],
      "severity": "medium",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-338",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use random_int() or random_bytes() instead."
    },
    {
      "id": "PHP012",
      "name": "PHP Insecure ECB Mode",
      "description": "ECB mode detected. It leaks patterns in ciphertext.",
      "type": "regex",
      "pattern": "openssl_encrypt\\s*\\(.*ecb",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-327",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use AES-GCM or AES-CBC with random IVs."
    },
    {
      "id": "PHP013",
      "name": "PHP Hardcoded Database Credentials",
      "description": "Hardcoded DB credentials detected.",
      "type": "regex",
      "pattern": "define\\s*\\(\\s*['\"]DB_(HOST|USER|PASS|NAME)",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "high",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use environment variables or secrets manager."
    },
    {
      "id": "PHP014",
      "name": "PHP Insecure File Upload",
      "description": "File upload without validation detected.",
      "type": "regex",
      "pattern": "move_uploaded_file\\s*\\(",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "medium",
      "category": "insecure_file_upload",
      "cwe_id": "CWE-434",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Validate file type, size, extension; randomize name; store outside web root."
    },
    {
      "id": "PHP015",
      "name": "PHP Insecure Cookie Settings",
      "description": "Cookie set without Secure/HttpOnly/SameSite flags.",
      "type": "regex",
      "pattern": "setcookie\\s*\\(",
      "languages": ["php"],
      "severity": "medium",
      "confidence": "medium",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-614",
      "owasp_category": "A07:2021-Identification and Authentication Failures",
      "remediation": "Always set cookies with HttpOnly, Secure, and SameSite=strict."
    },
    {
      "id": "PHP016",
      "name": "PHP preg_replace with /e Modifier",
      "description": "preg_replace with /e modifier can execute code.",
      "type": "regex",
      "pattern": "preg_replace\\s*\\([^)]*/e[^)]*\\)",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-94",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Do not use /e; use preg_replace_callback instead."
    },
    {
      "id": "PHP017",
      "name": "PHP Dynamic Extension Loading",
      "description": "dl() dynamically loads PHP extensions, unsafe in production.",
      "type": "regex",
      "pattern": "dl\\s*\\(",
      "languages": ["php"],
      "severity": "high",
      "confidence": "high",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-749",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Do not use dl(); manage extensions in php.ini."
    },
    {
      "id": "PHP018",
      "name": "PHP Access Control via User Input",
      "description": "Access control decision appears to be based on user input.",
      "type": "regex",
      "pattern": "\\$_(GET|POST|REQUEST)\\s*\\[.*(role|admin|auth).*\\]",
      "languages": ["php"],
      "severity": "high",
      "confidence": "medium",
      "category": "broken_access_control",
      "cwe_id": "CWE-284",
      "owasp_category": "A01:2021-Broken Access Control",
      "remediation": "Enforce server-side authorization using session or token checks."
    },
    {
      "id": "PHP019",
      "name": "PHP Deprecated mysql_connect",
      "description": "Use of deprecated mysql_connect() detected.",
      "type": "regex",
      "pattern": "mysql_connect\\s*\\(",
      "languages": ["php"],
      "severity": "high",
      "confidence": "high",
      "category": "vulnerable_component",
      "cwe_id": "CWE-477",
      "owasp_category": "A06:2021-Vulnerable and Outdated Components",
      "remediation": "Migrate to PDO or mysqli with prepared statements."
    },
    {
      "id": "PHP020",
      "name": "PHP Potential SSRF",
      "description": "Potential SSRF: fetching external URL without validation.",
      "type": "regex",
      "pattern": "(curl_exec|file_get_contents|fopen)\\s*\\([^)]*http",
      "languages": ["php"],
      "severity": "high",
      "confidence": "medium",
      "category": "ssrf",
      "cwe_id": "CWE-918",
      "owasp_category": "A10:2021-SSRF",
      "remediation": "Validate and whitelist remote URLs before requesting."
    },
    {
      "id": "PHP021",
      "name": "PHP Weak Randomness (uniqid)",
      "description": "uniqid() is predictable and not secure for crypto use.",
      "type": "regex",
      "pattern": "uniqid\\(",
      "languages": ["php"],
      "severity": "medium",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-338",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use random_bytes() or openssl_random_pseudo_bytes()."
    },
    {
      "id": "PHP022",
      "name": "PHP Insecure Temporary File",
      "description": "tempnam() used with predictable prefix may lead to race conditions.",
      "type": "regex",
      "pattern": "tempnam\\s*\\(",
      "languages": ["php"],
      "severity": "high",
      "confidence": "medium",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-377",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Use sys_get_temp_dir() with random_bytes() for unpredictable names."
    },
    {
      "id": "PHP023",
      "name": "PHP Email Header Injection",
      "description": "mail() function with user input may allow header injection.",
      "type": "regex",
      "pattern": "mail\\(",
      "languages": ["php"],
      "severity": "high",
      "confidence": "medium",
      "category": "injection",
      "cwe_id": "CWE-93",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Sanitize inputs or use libraries like PHPMailer."
    },
    {
      "id": "PHP024",
      "name": "PHP Backticks Operator",
      "description": "Backticks operator executes shell commands.",
      "type": "regex",
      "pattern": "`.*?`",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "high",
      "category": "command_injection",
      "cwe_id": "CWE-78",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Avoid backticks, use safer APIs."
    },
    {
      "id": "PHP025",
      "name": "PHP Process Control Functions",
      "description": "Process control functions with user input can lead to RCE.",
      "type": "regex",
      "pattern": "(popen|proc_open)\\s*\\(",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "high",
      "category": "command_injection",
      "cwe_id": "CWE-78",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Avoid process control functions with untrusted input."
    },
    {
      "id": "PHP026",
      "name": "PHP HTTP Response Splitting",
      "description": "User input in header() may lead to HTTP response splitting.",
      "type": "regex",
      "pattern": "header\\s*\\(\\s*[\"']Location:.*\\$_(GET|POST|REQUEST)",
      "languages": ["php"],
      "severity": "high",
      "confidence": "medium",
      "category": "injection",
      "cwe_id": "CWE-113",
      "owasp_category": "A01:2021-Broken Access Control",
      "remediation": "Sanitize and validate redirect URLs. Use a fixed set of allowed destinations."
    },
    {
      "id": "PHP027",
      "name": "PHP Unsafe extract()",
      "description": "extract() with EXTR_SKIP → Unsafe variable overwrite.",
      "type": "regex",
      "pattern": "extract\\([^,]+,\\s*EXTR_SKIP\\)",
      "languages": ["php"],
      "severity": "high",
      "confidence": "medium",
      "category": "code_injection",
      "cwe_id": "CWE-621",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Avoid EXTR_SKIP; explicitly define variables."
    },
    {
      "id": "PHP028",
      "name": "PHP Unsafe Variable Variables",
      "description": "User input used to create variable names → Variable injection.",
      "type": "regex",
      "pattern": "\\$\\{[^}]*\\}",
      "languages": ["php"],
      "severity": "high",
      "confidence": "medium",
      "category": "code_injection",
      "cwe_id": "CWE-621",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Use arrays instead of variable variables."
    },
    {
      "id": "PHP029",
      "name": "PHP create_function Usage",
      "description": "Deprecated and insecure function create_function() used.",
      "type": "regex",
      "pattern": "create_function\\(",
      "languages": ["php"],
      "severity": "high",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-95",
      "owasp_category": "A08:2021-Software Integrity Failures",
      "remediation": "Use anonymous functions instead."
    },
    {
      "id": "PHP030",
      "name": "PHP Error Reporting Disabled",
      "description": "Error reporting suppressed.",
      "type": "regex",
      "pattern": "error_reporting\\(0\\)|ini_set\\(['\"]display_errors['\"],\\s*['\"]Off['\"]\\)",
      "languages": ["php"],
      "severity": "low",
      "confidence": "high",
      "category": "information_disclosure",
      "cwe_id": "CWE-209",
      "owasp_category": "A09:2021-Security Logging and Monitoring Failures",
      "remediation": "Do not disable error reporting completely; log securely instead."
    },
    {
      "id": "PY001",
      "name": "Python Eval Usage",
      "description": "Using eval() in Python can execute arbitrary code and is a security risk.",
      "type": "regex",
      "pattern": "\\beval\\s*\\(",
      "languages": ["python"],
      "severity": "critical",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-95",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Use ast.literal_eval() for parsing literals or implement proper input validation."
    },
    {
      "id": "PY002",
      "name": "Python Exec Usage",
      "description": "Using exec() can execute arbitrary code and poses significant security risks.",
      "type": "regex",
      "pattern": "\\bexec\\s*\\(",
      "languages": ["python"],
      "severity": "critical",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-95",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Avoid exec() entirely. Refactor code to use safer alternatives or sandboxed execution environments."
    },
    {
      "id": "PY003",
      "name": "Python Pickle Deserialization",
      "description": "Pickle deserialization of untrusted data can lead to arbitrary code execution.",
      "type": "regex",
      "pattern": "pickle\\.(load|loads)\\s*\\(",
      "languages": ["python"],
      "severity": "critical",
      "confidence": "high",
      "category": "insecure_deserialization",
      "cwe_id": "CWE-502",
      "owasp_category": "A08:2017-Insecure Deserialization",
      "remediation": "Use JSON or other safe serialization formats. If pickle is necessary, only deserialize trusted data."
    },
    {
      "id": "PY004",
      "name": "Python SQL String Formatting",
      "description": "String formatting in SQL queries can lead to SQL injection.",
      "type": "regex",
      "pattern": "(execute|executemany)\\s*\\([^)]*(%s|%d|\\{|format\\(|f['\"])",
      "languages": ["python"],
      "severity": "critical",
      "confidence": "medium",
      "category": "sql_injection",
      "cwe_id": "CWE-89",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Use parameterized queries with placeholders. Never use string formatting for SQL queries."
    },
    {
      "id": "PY005",
      "name": "Python Shell Injection",
      "description": "Shell command execution with user input can lead to command injection.",
      "type": "regex",
      "pattern": "(subprocess\\.(call|run|Popen)|os\\.system|os\\.popen)\\s*\\(",
      "languages": ["python"],
      "severity": "critical",
      "confidence": "high",
      "category": "command_injection",
      "cwe_id": "CWE-78",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Use subprocess with shell=False and pass arguments as a list. Validate and sanitize all inputs."
    },
    {
      "id": "PY006",
      "name": "Python Hardcoded Secret",
      "description": "Hardcoded API key, password, or secret detected in Python code.",
      "type": "regex",
      "pattern": "(?i)(AKIA[0-9A-Z]{16}|(?:['\"]?(?:password|passwd|pwd|secret|api[_-]?key|token)['\"]?\\s*[:=]\\s*['\"][A-Za-z0-9/+=]{8,}['\"])|(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])[A-Za-z0-9/+=]{32,})",
      "languages": ["python"],
      "severity": "critical",
      "confidence": "medium",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Remove hardcoded secrets. Store them securely in environment variables, configuration files, or a secrets manager."
    },
    {
      "id": "PY007",
      "name": "Python YAML Load",
      "description": "yaml.load() with untrusted input is unsafe.",
      "type": "regex",
      "pattern": "yaml\\.load\\s*\\(",
      "languages": ["python"],
      "severity": "critical",
      "confidence": "high",
      "category": "insecure_deserialization",
      "cwe_id": "CWE-502",
      "owasp_category": "A08:2021-Software and Data Integrity Failures",
      "remediation": "Use yaml.safe_load() instead of yaml.load() with untrusted input."
    },
    {
      "id": "PY008",
      "name": "Python Insecure HTTP Request",
      "description": "Unencrypted HTTP request detected.",
      "type": "regex",
      "pattern": "requests\\.(get|post|put|delete)\\(\\s*['\"]http://",
      "languages": ["python"],
      "severity": "medium",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-319",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use HTTPS for secure communication."
    },
    {
      "id": "PY009",
      "name": "Python SSL Verification Disabled",
      "description": "SSL certificate verification disabled.",
      "type": "regex",
      "pattern": "verify\\s*=\\s*False",
      "languages": ["python"],
      "severity": "high",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-295",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Do not disable SSL verification."
    },
    {
      "id": "PY010",
      "name": "Python Weak Hash Algorithm",
      "description": "MD5 is insecure for password hashing or integrity checks.",
      "type": "regex",
      "pattern": "hashlib\\.md5\\s*\\(",
      "languages": ["python"],
      "severity": "medium",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-327",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use SHA-256 or stronger. For passwords, use bcrypt/argon2."
    },
    {
      "id": "PY011",
      "name": "Python Weak Randomness",
      "description": "Use of weak PRNG for security-sensitive purposes.",
      "type": "regex",
      "pattern": "random\\.(random|randint|choice)\\s*\\(",
      "languages": ["python"],
      "severity": "low",
      "confidence": "medium",
      "category": "weak_crypto",
      "cwe_id": "CWE-338",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use secrets module or os.urandom()."
    },
    {
      "id": "PY012",
      "name": "Python Path Traversal Risk",
      "description": "Opening files with untrusted input may allow path traversal.",
      "type": "regex",
      "pattern": "open\\s*\\([^)]*\\+.*(input|request)",
      "languages": ["python"],
      "severity": "high",
      "confidence": "medium",
      "category": "path_traversal",
      "cwe_id": "CWE-22",
      "owasp_category": "A01:2021-Broken Access Control",
      "remediation": "Validate and sanitize file paths before use."
    },
    {
      "id": "PY013",
      "name": "Python Insecure Temporary File",
      "description": "tempfile.mktemp() is unsafe due to race conditions.",
      "type": "regex",
      "pattern": "tempfile\\.mktemp\\s*\\(",
      "languages": ["python"],
      "severity": "high",
      "confidence": "high",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-377",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Use NamedTemporaryFile(delete=True)."
    },
    {
      "id": "PY014",
      "name": "Python Swallowed Exceptions",
      "description": "Swallowing exceptions without handling.",
      "type": "regex",
      "pattern": "except\\s*Exception\\s*:\\s*pass",
      "languages": ["python"],
      "severity": "medium",
      "confidence": "high",
      "category": "code_quality",
      "cwe_id": "CWE-391",
      "owasp_category": "A09:2021-Security Logging and Monitoring Failures",
      "remediation": "Handle exceptions properly or log securely."
    },
    {
      "id": "PY015",
      "name": "Python Debug Mode Enabled",
      "description": "Debug mode is enabled. This exposes stack traces and an interactive console in production.",
      "type": "regex",
      "pattern": "app\\.run\\(.*debug\\s*=\\s*True.*\\)",
      "languages": ["python"],
      "severity": "high",
      "confidence": "high",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-489",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Disable debug mode in production. Use environment-specific settings."
    },
    {
      "id": "PY016",
      "name": "Python Insecure Cookie Settings",
      "description": "Cookie set without Secure or HttpOnly flags.",
      "type": "regex",
      "pattern": "set_cookie\\(",
      "languages": ["python"],
      "severity": "high",
      "confidence": "low",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-614",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Always set cookies with Secure=True and HttpOnly=True."
    },
    {
      "id": "PY017",
      "name": "Python Insecure File Permissions",
      "description": "Insecure file permissions (0o777) allow read/write/execute access by anyone.",
      "type": "regex",
      "pattern": "0o777",
      "languages": ["python"],
      "severity": "medium",
      "confidence": "high",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-732",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Restrict file permissions. Use least privilege (e.g., 0o600 or 0o640)."
    },
    {
      "id": "PY018",
      "name": "Python XXE Vulnerability",
      "description": "XML parsing without disabling external entities can allow XXE attacks.",
      "type": "regex",
      "pattern": "xml\\.etree\\.ElementTree\\.parse\\(|ET\\.parse\\(|minidom\\.parse\\(",
      "languages": ["python"],
      "severity": "critical",
      "confidence": "medium",
      "category": "xxe",
      "cwe_id": "CWE-611",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Disable external entity resolution (use defusedxml or configure parser securely)."
    },
    {
      "id": "PY019",
      "name": "Python SSTI Risk",
      "description": "User input rendered directly in template context may allow remote code execution.",
      "type": "regex",
      "pattern": "render_template_string\\(",
      "languages": ["python"],
      "severity": "critical",
      "confidence": "medium",
      "category": "code_injection",
      "cwe_id": "CWE-94",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Avoid rendering user-controlled input. Use safe template variables and context separation."
    },
    {
      "id": "PY020",
      "name": "Python Unrestricted File Upload",
      "description": "File upload without validation may allow dangerous file uploads.",
      "type": "regex",
      "pattern": "upload_file\\(",
      "languages": ["python"],
      "severity": "critical",
      "confidence": "low",
      "category": "insecure_file_upload",
      "cwe_id": "CWE-434",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Validate file extensions and MIME types. Store uploads outside the webroot."
    },
    {
      "id": "JAVA001",
      "name": "Java SQL Injection",
      "description": "String concatenation in SQL statements can lead to SQL injection.",
      "type": "regex",
      "pattern": "(executeQuery|executeUpdate|execute)\\s*\\([^)]*\\+",
      "languages": ["java"],
      "severity": "critical",
      "confidence": "medium",
      "category": "sql_injection",
      "cwe_id": "CWE-89",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Use PreparedStatement with parameterized queries instead of string concatenation."
    },
    {
      "id": "JAVA002",
      "name": "Java Deserialization",
      "description": "Java object deserialization can lead to remote code execution.",
      "type": "regex",
      "pattern": "ObjectInputStream\\s*\\(",
      "languages": ["java"],
      "severity": "critical",
      "confidence": "high",
      "category": "insecure_deserialization",
      "cwe_id": "CWE-502",
      "owasp_category": "A08:2017-Insecure Deserialization",
      "remediation": "Avoid Java serialization for untrusted data. Use JSON or implement look-ahead deserialization."
    },
    {
      "id": "JAVA003",
      "name": "Java Command Injection",
      "description": "Runtime.exec() with user input can lead to command injection.",
      "type": "regex",
      "pattern": "Runtime\\.getRuntime\\(\\)\\.exec\\s*\\(",
      "languages": ["java"],
      "severity": "critical",
      "confidence": "high",
      "category": "command_injection",
      "cwe_id": "CWE-78",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Use ProcessBuilder with argument list. Validate and sanitize all command parameters."
    },
    {
      "id": "JAVA004",
      "name": "Java XXE Vulnerability",
      "description": "XML parsing without disabling external entities can lead to XXE attacks.",
      "type": "regex",
      "pattern": "DocumentBuilderFactory\\.newInstance\\(\\)",
      "languages": ["java"],
      "severity": "critical",
      "confidence": "medium",
      "category": "xxe",
      "cwe_id": "CWE-611",
      "owasp_category": "A04:2017-XML External Entities (XXE)",
      "remediation": "Disable external entity processing: factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)."
    },
    {
      "id": "JAVA005",
      "name": "Java Hardcoded Password",
      "description": "Hardcoded password detected.",
      "type": "regex",
      "pattern": "(password|passwd)\\s*=\\s*\".*\"",
      "languages": ["java"],
      "severity": "critical",
      "confidence": "medium",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Remove hardcoded credentials. Use config or secrets manager."
    },
    {
      "id": "JAVA006",
      "name": "Java Weak Hash Algorithm",
      "description": "Weak hashing algorithm (MD5/SHA1) used.",
      "type": "regex",
      "pattern": "MessageDigest\\.getInstance\\(\"(MD5|SHA1)\"\\)",
      "languages": ["java"],
      "severity": "high",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-327",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use SHA-256 or stronger."
    },
    {
      "id": "JAVA007",
      "name": "Java Insecure Randomness",
      "description": "java.util.Random is not cryptographically secure.",
      "type": "regex",
      "pattern": "new\\s+Random\\s*\\(",
      "languages": ["java"],
      "severity": "medium",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-338",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Use java.security.SecureRandom for security-sensitive cases."
    },
    {
      "id": "JAVA008",
      "name": "Java Path Traversal Risk",
      "description": "File operations on untrusted input may allow path traversal.",
      "type": "regex",
      "pattern": "(FileReader|FileInputStream)\\s*\\([^)]*\\+.*request\\.getParameter",
      "languages": ["java"],
      "severity": "high",
      "confidence": "medium",
      "category": "path_traversal",
      "cwe_id": "CWE-22",
      "owasp_category": "A01:2021-Broken Access Control",
      "remediation": "Sanitize and validate file paths."
    },
    {
      "id": "JAVA009",
      "name": "Java Sensitive Data Logging",
      "description": "Logging sensitive data may expose secrets.",
      "type": "regex",
      "pattern": "logger\\.(info|debug|error)\\(.*(password|secret|token).*\\)",
      "languages": ["java"],
      "severity": "medium",
      "confidence": "medium",
      "category": "information_disclosure",
      "cwe_id": "CWE-532",
      "owasp_category": "A09:2021-Security Logging and Monitoring Failures",
      "remediation": "Avoid logging credentials or sensitive data."
    },
    {
      "id": "JAVA010",
      "name": "Java SSL Verification Disabled",
      "description": "Disabling SSL hostname verification is insecure.",
      "type": "regex",
      "pattern": "setHostnameVerifier\\s*\\(\\s*\\(hostname, session\\) -> true\\)",
      "languages": ["java"],
      "severity": "high",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-295",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Enable proper SSL verification."
    },
    {
      "id": "JAVA011",
      "name": "Java Stack Trace Leakage",
      "description": "Stack trace leakage.",
      "type": "regex",
      "pattern": "printStackTrace\\(",
      "languages": ["java"],
      "severity": "medium",
      "confidence": "high",
      "category": "information_disclosure",
      "cwe_id": "CWE-209",
      "owasp_category": "A09:2021-Security Logging and Monitoring Failures",
      "remediation": "Log securely without exposing stack traces."
    },
    {
      "id": "JAVA012",
      "name": "Java Insecure Temporary File",
      "description": "File.createTempFile() without proper security checks.",
      "type": "regex",
      "pattern": "File\\.createTempFile\\s*\\(",
      "languages": ["java"],
      "severity": "medium",
      "confidence": "medium",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-377",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Restrict permissions and validate paths when creating temp files."
    },
    {
      "id": "JAVA013",
      "name": "Java Hardcoded API Key",
      "description": "Hardcoded API key, token, or secret detected in Java source code.",
      "type": "regex",
      "pattern": "(?i)\\b(API[_-]?KEY|SECRET|TOKEN|ACCESS[_-]?KEY|AUTH)\\b\\s*=\\s*\"[A-Za-z0-9+/=_\\-]{16,}\"",
      "languages": ["java"],
      "severity": "critical",
      "confidence": "medium",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A07:2021-Identification and Authentication Failures",
      "remediation": "Do not hardcode API keys/secrets. Use environment variables, secure config files, or a secrets manager."
    },
    {
      "id": "JAVA014",
      "name": "Java Plaintext Password Storage",
      "description": "Plaintext password storage or comparison detected.",
      "type": "regex",
      "pattern": "(?i)(String\\s+password\\s*=\\s*\"[^\"]+\"|password\\s*==\\s*\"[^\"]+\")",
      "languages": ["java"],
      "severity": "critical",
      "confidence": "medium",
      "category": "information_disclosure",
      "cwe_id": "CWE-256",
      "owasp_category": "A07:2021-Identification and Authentication Failures",
      "remediation": "Hash passwords using strong algorithms (bcrypt, Argon2) before storing and use secure comparison methods."
    },
    {
      "id": "JAVA015",
      "name": "Java Reflection Misuse",
      "description": "Reflection used with user input can lead to code execution.",
      "type": "regex",
      "pattern": "Class\\.forName\\s*\\([^)]*\\+.*request",
      "languages": ["java"],
      "severity": "critical",
      "confidence": "medium",
      "category": "code_injection",
      "cwe_id": "CWE-470",
      "owasp_category": "A03:2021-Injection",
      "remediation": "Do not allow user input in reflection APIs."
    },
    {
      "id": "GEN001",
      "name": "Hardcoded Private Key",
      "description": "Private keys should never be stored in source code.",
      "type": "regex",
      "pattern": "-----BEGIN (RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----",
      "languages": ["*"],
      "severity": "critical",
      "confidence": "high",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A3:2017-Sensitive Data Exposure",
      "remediation": "Store private keys in secure key management systems. Never commit keys to version control."
    },
    {
      "id": "GEN002",
      "name": "Security TODO/FIXME Comments",
      "description": "TODO/FIXME comments mentioning security issues indicate unresolved problems.",
      "type": "regex",
      "pattern": "(TODO|FIXME|XXX|HACK).*?(security|vuln|auth|password|secret|unsafe|insecure)",
      "languages": ["*"],
      "severity": "info",
      "confidence": "low",
      "category": "code_quality",
      "cwe_id": null,
      "owasp_category": null,
      "remediation": "Address the security concern mentioned in the comment before deployment."
    },
    {
      "id": "GEN003",
      "name": "Debug Mode Enabled",
      "description": "Debug mode or verbose logging may expose sensitive information in production.",
      "type": "regex",
      "pattern": "(DEBUG|debug)\\s*[=:]\\s*(true|True|1|on)",
      "languages": ["*"],
      "severity": "medium",
      "confidence": "low",
      "category": "information_disclosure",
      "cwe_id": "CWE-215",
      "owasp_category": "A6:2017-Security Misconfiguration",
      "remediation": "Ensure debug mode is disabled in production. Use environment-specific configuration."
    },
    {
      "id": "GEN004",
      "name": "Hardcoded IP Address",
      "description": "Hardcoded IP addresses may indicate security misconfigurations or development artifacts.",
      "type": "regex",
      "pattern": "\\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b",
      "languages": ["*"],
      "severity": "info",
      "confidence": "low",
      "category": "information_disclosure",
      "cwe_id": "CWE-200",
      "owasp_category": null,
      "remediation": "Use configuration files or environment variables for IP addresses. Review if the IP is appropriate for the context."
    },
    {
      "id": "GEN005",
      "name": "Weak Hash Algorithm (MD5/SHA1)",
      "description": "MD5 and SHA1 are considered weak for security purposes.",
      "type": "regex",
      "pattern": "(md5|sha1)\\s*\\(",
      "languages": ["*"],
      "severity": "medium",
      "confidence": "medium",
      "category": "weak_crypto",
      "cwe_id": "CWE-328",
      "owasp_category": "A3:2017-Sensitive Data Exposure",
      "remediation": "Use SHA-256 or stronger hash algorithms. For passwords, use bcrypt, scrypt, or Argon2."
    },
    {
      "id": "GEN006",
      "name": "AWS Access Key Exposure",
      "description": "AWS access keys should never be hardcoded in source code.",
      "type": "regex",
      "pattern": "AKIA[0-9A-Z]{16}",
      "languages": ["*"],
      "severity": "critical",
      "confidence": "high",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A3:2017-Sensitive Data Exposure",
      "remediation": "Use AWS IAM roles, environment variables, or AWS Secrets Manager for credential management."
    },
    {
      "id": "GEN007",
      "name": "JWT Secret in Code",
      "description": "JWT secrets hardcoded in source code can lead to token forgery.",
      "type": "regex",
      "pattern": "(jwt[_-]?secret|JWT_SECRET)\\s*[=:]\\s*['\"][^'\"]+['\"]",
      "languages": ["*"],
      "severity": "critical",
      "confidence": "high",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A2:2017-Broken Authentication",
      "remediation": "Store JWT secrets in environment variables or secure key management systems."
    },
    {
      "id": "GEN008",
      "name": "Insecure TLS Configuration",
      "description": "TLS certificate validation is disabled.",
      "type": "regex",
      "pattern": "NODE_TLS_REJECT_UNAUTHORIZED\\s*=?\\s*['\"]?0['\"]?|CURLOPT_SSL_VERIFYPEER\\s*,\\s*false",
      "languages": ["*"],
      "severity": "high",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-295",
      "owasp_category": "A02:2021-Cryptographic Failures",
      "remediation": "Enable TLS verification to prevent MITM attacks."
    },
    {
      "id": "GEN009",
      "name": "Insecure File Permissions",
      "description": "Insecure file permissions (777/0777) detected.",
      "type": "regex",
      "pattern": "chmod\\(.*777|0o777",
      "languages": ["*"],
      "severity": "medium",
      "confidence": "high",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-732",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Restrict permissions to the minimum required (e.g., 640 or 750)."
    },
    {
      "id": "GEN010",
      "name": "Hardcoded HTTP URL",
      "description": "Use of insecure hardcoded HTTP URL detected.",
      "type": "regex",
      "pattern": "['\"`]http://[\\w./?#=&%-]+",
      "languages": ["*"],
      "severity": "medium",
      "confidence": "high",
      "category": "weak_crypto",
      "cwe_id": "CWE-319",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Use HTTPS for secure communication instead of HTTP."
    },
    {
      "id": "GEN011",
      "name": "Base64 Obfuscation",
      "description": "Very large base64/encoded string detected (possible obfuscation or embedded payload).",
      "type": "regex",
      "pattern": "[A-Za-z0-9+/]{200,}={0,2}",
      "languages": ["*"],
      "severity": "medium",
      "confidence": "low",
      "category": "code_quality",
      "cwe_id": "CWE-94",
      "owasp_category": "A04:2021-Insecure Design",
      "remediation": "Review encoded content carefully for hidden or malicious data."
    },
    {
      "id": "GEN012",
      "name": "Empty Exception Handling",
      "description": "Empty catch block found, errors may be silently ignored.",
      "type": "regex",
      "pattern": "catch\\s*\\([^)]*\\)\\s*\\{\\s*\\}",
      "languages": ["*"],
      "severity": "low",
      "confidence": "high",
      "category": "code_quality",
      "cwe_id": "CWE-391",
      "owasp_category": "A09:2021-Security Logging and Monitoring Failures",
      "remediation": "Log, rethrow, or handle exceptions securely instead of swallowing them."
    },
    {
      "id": "GEN013",
      "name": "Clickjacking Risk - Missing X-Frame-Options",
      "description": "Missing X-Frame-Options header increases clickjacking risk.",
      "type": "regex",
      "pattern": "header\\s*\\(\\s*['\"]X-Frame-Options",
      "languages": ["*"],
      "severity": "low",
      "confidence": "low",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-1021",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Add X-Frame-Options: DENY header to prevent clickjacking."
    },
    {
      "id": "GEN014",
      "name": "Sensitive Data Logging",
      "description": "Sensitive data logged using logging functions.",
      "type": "regex",
      "pattern": "(logging\\.|logger\\.|error_log\\(|console\\.).*(password|secret|token)",
      "languages": ["*"],
      "severity": "medium",
      "confidence": "medium",
      "category": "information_disclosure",
      "cwe_id": "CWE-532",
      "owasp_category": "A09:2021-Security Logging and Monitoring Failures",
      "remediation": "Avoid logging secrets or scrub them first."
    },
    {
      "id": "GEN015",
      "name": "Insecure Temporary File Creation",
      "description": "Insecure temporary file creation may lead to race conditions.",
      "type": "regex",
      "pattern": "(tempfile\\.mktemp|File\\.createTempFile|tempnam)\\s*\\(",
      "languages": ["*"],
      "severity": "high",
      "confidence": "medium",
      "category": "security_misconfiguration",
      "cwe_id": "CWE-377",
      "owasp_category": "A05:2021-Security Misconfiguration",
      "remediation": "Use secure temporary file creation methods with proper permissions."
    }
  ]
}