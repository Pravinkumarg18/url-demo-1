{
  "version": "1.0.0",
  "description": "Security rules for static code analysis",
  "last_updated": "2025-01-01",
  "rules": [
    {
      "id": "JS001",
      "name": "Hardcoded API Key",
      "description": "Detects hardcoded API keys in JavaScript code which could lead to unauthorized access if exposed.",
      "type": "regex",
      "pattern": "(api[_-]?key|apikey|api_secret)\\s*[=:]\\s*['\"][a-zA-Z0-9_\\-]{16,}['\"]",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "medium",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A3:2017-Sensitive Data Exposure",
      "remediation": "Store API keys in environment variables or secure configuration management systems. Never commit secrets to source control."
    },
    {
      "id": "JS002",
      "name": "Hardcoded Password",
      "description": "Detects hardcoded passwords which could be exploited if source code is exposed.",
      "type": "regex",
      "pattern": "(password|passwd|pwd)\\s*[=:]\\s*['\"][^'\"]{4,}['\"]",
      "languages": ["javascript", "typescript", "python", "php", "java"],
      "severity": "critical",
      "confidence": "medium",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A3:2017-Sensitive Data Exposure",
      "remediation": "Use environment variables or secure vaults for storing credentials. Implement proper secrets management."
    },
    {
      "id": "JS003",
      "name": "Eval Usage",
      "description": "Using eval() can execute arbitrary code and is a significant security risk.",
      "type": "regex",
      "pattern": "\\beval\\s*\\(",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-95",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Avoid using eval(). Use safer alternatives like JSON.parse() for parsing JSON or Function constructor with caution."
    },
    {
      "id": "JS004",
      "name": "innerHTML Assignment",
      "description": "Direct innerHTML assignment can lead to Cross-Site Scripting (XSS) vulnerabilities.",
      "type": "regex",
      "pattern": "\\.innerHTML\\s*=",
      "languages": ["javascript", "typescript"],
      "severity": "medium",
      "confidence": "medium",
      "category": "xss",
      "cwe_id": "CWE-79",
      "owasp_category": "A7:2017-Cross-Site Scripting (XSS)",
      "remediation": "Use textContent for plain text or sanitize HTML content before assignment. Consider using DOM manipulation methods instead."
    },
    {
      "id": "JS005",
      "name": "document.write Usage",
      "description": "document.write() can be exploited for XSS attacks and degrades page performance.",
      "type": "regex",
      "pattern": "document\\.write\\s*\\(",
      "languages": ["javascript", "typescript"],
      "severity": "medium",
      "confidence": "high",
      "category": "xss",
      "cwe_id": "CWE-79",
      "owasp_category": "A7:2017-Cross-Site Scripting (XSS)",
      "remediation": "Use DOM manipulation methods like createElement() and appendChild() instead of document.write()."
    },
    {
      "id": "JS006",
      "name": "Insecure Random",
      "description": "Math.random() is not cryptographically secure and should not be used for security-sensitive operations.",
      "type": "regex",
      "pattern": "Math\\.random\\s*\\(\\)",
      "languages": ["javascript", "typescript"],
      "severity": "low",
      "confidence": "medium",
      "category": "weak_crypto",
      "cwe_id": "CWE-330",
      "owasp_category": "A6:2017-Security Misconfiguration",
      "remediation": "Use crypto.getRandomValues() or crypto.randomUUID() for security-sensitive random number generation."
    },
    {
      "id": "JS007",
      "name": "SQL Injection Risk",
      "description": "String concatenation in SQL queries may lead to SQL injection vulnerabilities.",
      "type": "regex",
      "pattern": "(query|execute)\\s*\\(\\s*['\"`]\\s*(SELECT|INSERT|UPDATE|DELETE).*\\+",
      "languages": ["javascript", "typescript"],
      "severity": "critical",
      "confidence": "medium",
      "category": "sql_injection",
      "cwe_id": "CWE-89",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Use parameterized queries or prepared statements. Never concatenate user input directly into SQL queries."
    },
    {
      "id": "JS008",
      "name": "Exposed AWS Access Key",
      "description": "AWS access keys should never be hardcoded in source code.",
      "type": "regex",
      "pattern": "AKIA[0-9A-Z]{16}",
      "languages": ["*"],
      "severity": "critical",
      "confidence": "high",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A3:2017-Sensitive Data Exposure",
      "remediation": "Use AWS IAM roles, environment variables, or AWS Secrets Manager for credential management."
    },
    {
      "id": "JS009",
      "name": "JWT Secret in Code",
      "description": "JWT secrets hardcoded in source code can lead to token forgery.",
      "type": "regex",
      "pattern": "(jwt[_-]?secret|JWT_SECRET)\\s*[=:]\\s*['\"][^'\"]+['\"]",
      "languages": ["*"],
      "severity": "critical",
      "confidence": "high",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A2:2017-Broken Authentication",
      "remediation": "Store JWT secrets in environment variables or secure key management systems."
    },
    {
      "id": "JS010",
      "name": "Prototype Pollution Risk",
      "description": "Object property assignment patterns that may lead to prototype pollution.",
      "type": "ast",
      "languages": ["javascript", "typescript"],
      "severity": "high",
      "confidence": "medium",
      "category": "code_injection",
      "cwe_id": "CWE-1321",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Validate and sanitize object keys. Use Object.create(null) for dictionary objects. Consider using Map instead."
    },
    {
      "id": "PY001",
      "name": "Python Eval Usage",
      "description": "Using eval() in Python can execute arbitrary code and is a security risk.",
      "type": "regex",
      "pattern": "\\beval\\s*\\(",
      "languages": ["python"],
      "severity": "high",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-95",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Use ast.literal_eval() for parsing literals or implement proper input validation."
    },
    {
      "id": "PY002",
      "name": "Python Exec Usage",
      "description": "Using exec() can execute arbitrary code and poses significant security risks.",
      "type": "regex",
      "pattern": "\\bexec\\s*\\(",
      "languages": ["python"],
      "severity": "high",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-95",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Avoid exec() entirely. Refactor code to use safer alternatives or sandboxed execution environments."
    },
    {
      "id": "PY003",
      "name": "Python Pickle Deserialization",
      "description": "Pickle deserialization of untrusted data can lead to arbitrary code execution.",
      "type": "regex",
      "pattern": "pickle\\.(load|loads)\\s*\\(",
      "languages": ["python"],
      "severity": "high",
      "confidence": "medium",
      "category": "insecure_deserialization",
      "cwe_id": "CWE-502",
      "owasp_category": "A8:2017-Insecure Deserialization",
      "remediation": "Use JSON or other safe serialization formats. If pickle is necessary, only deserialize trusted data."
    },
    {
      "id": "PY004",
      "name": "Python SQL String Formatting",
      "description": "String formatting in SQL queries can lead to SQL injection.",
      "type": "regex",
      "pattern": "(execute|executemany)\\s*\\([^)]*(%s|%d|\\{|format\\(|f['\"])",
      "languages": ["python"],
      "severity": "critical",
      "confidence": "medium",
      "category": "sql_injection",
      "cwe_id": "CWE-89",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Use parameterized queries with placeholders. Never use string formatting for SQL queries."
    },
    {
      "id": "PY005",
      "name": "Python Shell Injection",
      "description": "Shell command execution with user input can lead to command injection.",
      "type": "regex",
      "pattern": "(subprocess\\.(call|run|Popen)|os\\.system|os\\.popen)\\s*\\(",
      "languages": ["python"],
      "severity": "high",
      "confidence": "medium",
      "category": "command_injection",
      "cwe_id": "CWE-78",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Use subprocess with shell=False and pass arguments as a list. Validate and sanitize all inputs."
    },
    {
      "id": "PHP001",
      "name": "PHP Eval Usage",
      "description": "Using eval() in PHP can execute arbitrary code.",
      "type": "regex",
      "pattern": "\\beval\\s*\\(",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "high",
      "category": "code_injection",
      "cwe_id": "CWE-95",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Avoid eval(). Use include/require for dynamic code loading with proper validation."
    },
    {
      "id": "PHP002",
      "name": "PHP SQL Injection",
      "description": "Direct variable interpolation in SQL queries can lead to SQL injection.",
      "type": "regex",
      "pattern": "(mysql_query|mysqli_query|pg_query)\\s*\\([^)]*\\$",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "high",
      "category": "sql_injection",
      "cwe_id": "CWE-89",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Use prepared statements with PDO or mysqli. Never interpolate variables directly into SQL."
    },
    {
      "id": "PHP003",
      "name": "PHP Include Vulnerability",
      "description": "Dynamic file inclusion can lead to Local/Remote File Inclusion vulnerabilities.",
      "type": "regex",
      "pattern": "(include|require|include_once|require_once)\\s*\\(?\\s*\\$",
      "languages": ["php"],
      "severity": "critical",
      "confidence": "medium",
      "category": "path_traversal",
      "cwe_id": "CWE-98",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Use a whitelist of allowed files. Validate and sanitize file paths. Disable allow_url_include."
    },
    {
      "id": "PHP004",
      "name": "PHP Unserialize",
      "description": "Unserializing user-controlled data can lead to object injection.",
      "type": "regex",
      "pattern": "\\bunserialize\\s*\\(",
      "languages": ["php"],
      "severity": "high",
      "confidence": "medium",
      "category": "insecure_deserialization",
      "cwe_id": "CWE-502",
      "owasp_category": "A8:2017-Insecure Deserialization",
      "remediation": "Use JSON for data serialization. If unserialize is necessary, use allowed_classes parameter."
    },
    {
      "id": "JAVA001",
      "name": "Java SQL Injection",
      "description": "String concatenation in SQL statements can lead to SQL injection.",
      "type": "regex",
      "pattern": "(executeQuery|executeUpdate|execute)\\s*\\([^)]*\\+",
      "languages": ["java"],
      "severity": "critical",
      "confidence": "medium",
      "category": "sql_injection",
      "cwe_id": "CWE-89",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Use PreparedStatement with parameterized queries instead of string concatenation."
    },
    {
      "id": "JAVA002",
      "name": "Java Deserialization",
      "description": "Java object deserialization can lead to remote code execution.",
      "type": "regex",
      "pattern": "ObjectInputStream\\s*\\(",
      "languages": ["java"],
      "severity": "high",
      "confidence": "medium",
      "category": "insecure_deserialization",
      "cwe_id": "CWE-502",
      "owasp_category": "A8:2017-Insecure Deserialization",
      "remediation": "Avoid Java serialization for untrusted data. Use JSON or implement look-ahead deserialization."
    },
    {
      "id": "JAVA003",
      "name": "Java Command Injection",
      "description": "Runtime.exec() with user input can lead to command injection.",
      "type": "regex",
      "pattern": "Runtime\\.getRuntime\\(\\)\\.exec\\s*\\(",
      "languages": ["java"],
      "severity": "high",
      "confidence": "medium",
      "category": "command_injection",
      "cwe_id": "CWE-78",
      "owasp_category": "A1:2017-Injection",
      "remediation": "Use ProcessBuilder with argument list. Validate and sanitize all command parameters."
    },
    {
      "id": "JAVA004",
      "name": "Java XXE Vulnerability",
      "description": "XML parsing without disabling external entities can lead to XXE attacks.",
      "type": "regex",
      "pattern": "DocumentBuilderFactory\\.newInstance\\(\\)",
      "languages": ["java"],
      "severity": "high",
      "confidence": "low",
      "category": "xxe",
      "cwe_id": "CWE-611",
      "owasp_category": "A4:2017-XML External Entities (XXE)",
      "remediation": "Disable external entity processing: factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)."
    },
    {
      "id": "GEN001",
      "name": "Private Key in Code",
      "description": "Private keys should never be stored in source code.",
      "type": "regex",
      "pattern": "-----BEGIN (RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----",
      "languages": ["*"],
      "severity": "critical",
      "confidence": "high",
      "category": "hardcoded_secret",
      "cwe_id": "CWE-798",
      "owasp_category": "A3:2017-Sensitive Data Exposure",
      "remediation": "Store private keys in secure key management systems. Never commit keys to version control."
    },
    {
      "id": "GEN002",
      "name": "TODO Security Comment",
      "description": "TODO/FIXME comments mentioning security issues indicate unresolved problems.",
      "type": "regex",
      "pattern": "(TODO|FIXME|XXX|HACK).*?(security|vuln|auth|password|secret|unsafe|insecure)",
      "languages": ["*"],
      "severity": "info",
      "confidence": "low",
      "category": "code_quality",
      "cwe_id": null,
      "owasp_category": null,
      "remediation": "Address the security concern mentioned in the comment before deployment."
    },
    {
      "id": "GEN003",
      "name": "Debug Mode Enabled",
      "description": "Debug mode or verbose logging may expose sensitive information in production.",
      "type": "regex",
      "pattern": "(DEBUG|debug)\\s*[=:]\\s*(true|True|1|on)",
      "languages": ["*"],
      "severity": "medium",
      "confidence": "low",
      "category": "information_disclosure",
      "cwe_id": "CWE-215",
      "owasp_category": "A6:2017-Security Misconfiguration",
      "remediation": "Ensure debug mode is disabled in production. Use environment-specific configuration."
    },
    {
      "id": "GEN004",
      "name": "Hardcoded IP Address",
      "description": "Hardcoded IP addresses may indicate security misconfigurations or development artifacts.",
      "type": "regex",
      "pattern": "\\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b",
      "languages": ["*"],
      "severity": "info",
      "confidence": "low",
      "category": "information_disclosure",
      "cwe_id": "CWE-200",
      "owasp_category": null,
      "remediation": "Use configuration files or environment variables for IP addresses. Review if the IP is appropriate for the context."
    },
    {
      "id": "GEN005",
      "name": "Weak Hash Algorithm",
      "description": "MD5 and SHA1 are considered weak for security purposes.",
      "type": "regex",
      "pattern": "(md5|sha1)\\s*\\(",
      "languages": ["*"],
      "severity": "medium",
      "confidence": "medium",
      "category": "weak_crypto",
      "cwe_id": "CWE-328",
      "owasp_category": "A3:2017-Sensitive Data Exposure",
      "remediation": "Use SHA-256 or stronger hash algorithms. For passwords, use bcrypt, scrypt, or Argon2."
    }
  ]
}
